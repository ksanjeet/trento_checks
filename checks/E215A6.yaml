id: "E215A6"
name: SAPHanaFilesystem resource configured
group: Pacemaker
description: |
  SAPHanaFilesystem resource is configured
remediation: |
  ## Abstract
  SAPHanaFilesystem resource should be configured especially for hana_scale_out clusters. So, that problems with HANA filesystem can be monitored and remediative steps can be taken by cluster if the resource is hung due to the fileystem unavailability.
  ## Remediation

  Configure SAPHanaFilesystem resource.

  ## References
  AZURE:

    - https://documentation.suse.com/sbp/sap-15/html/SLES4SAP-hana-angi-scaleout-perfopt-15/index.html#id-saphanafilesystem

  AWS:

    - https://documentation.suse.com/sbp/sap-15/html/SLES4SAP-hana-angi-scaleout-perfopt-15/index.html#id-saphanafilesystem

  GCP:

    - https://documentation.suse.com/sbp/sap-15/html/SLES4SAP-hana-angi-scaleout-perfopt-15/index.html#id-saphanafilesystem

  SUSE / KVM:

    - https://documentation.suse.com/sbp/sap-15/html/SLES4SAP-hana-angi-scaleout-perfopt-15/index.html#id-saphanafilesystem

  Nutanix:

    - https://documentation.suse.com/sbp/sap-15/html/SLES4SAP-hana-angi-scaleout-perfopt-15/index.html#id-saphanafilesystem

severity: warning
metadata:
  target_type: cluster
  cluster_type: 
    - hana_scale_up
    - hana_scale_out
  architecture_type: angi

facts:
  - name: resource_filesystem
    gatherer: cibadmin
    argument: cib.configuration.resources

values:
  - name: resource_type
    default: "SAPHanaFilesystem"      

expectations:
  - name: expectations_resource_filesystem
    expect: |
            let hana_ct = facts.resource_filesystem.clone;
            for cln in hana_ct {
              let fil = cln.primitive;
                for prim in fil {
                    if prim.type == values.resource_type {return true;}       
                }
            }            
