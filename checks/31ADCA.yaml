id: "31ADCA"
name: supported SAPHanaSR-angi version 
group: OS and package versions
description: |
  SAPHanaSR-angi version is supported
remediation: |
  ## Abstract
  Installed SAPHanaSR-angi version must be equal or higher than the recommended value
  ## Remediation
  Install or upgrade to a supported SAPHanaSR-angi version
  ## Reference
  As it is highly recommended to use the HA/DR provider hook when running SAP workloads in HA environments and the HA/DR provider hook support started with SAPHanaSR-angi version 1.2.5, delivered on installation media of 15SP6 and as update package for 15SP5, the version of the SAPHanaSR-angi package must be at least 1.2.5.
  - https://documentation.suse.com/sbp/all/single-html/SLES4SAP-hana-sr-guide-PerfOpt-15/#id-installing-additional-software
    (EXAMPLE 1:Installing additional software for the HA cluster)

severity: critical
metadata:
  target_type: cluster
  cluster_type: 
    - hana_scale_up
    - hana_scale_out
  architecture_type: angi

facts:
  - name: compare_angi_version
    gatherer: package_version@v1
    argument: SAPHanaSR-angi,1.2.5

expectations:
  - name: expectations_angi_version
    expect: facts.compare_angi_version < 1
    failure_message: The installed SAPHanaSR-angi version is older than the recommended version (1.2.5)
